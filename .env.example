# ==========================================
# Application
# ==========================================
NODE_ENV=development
PORT=3000
LOG_LEVEL=info                    # trace | debug | info | warn | error | fatal

# ==========================================
# Database (PostgreSQL)
# ==========================================
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
DATABASE_URL=postgresql://appuser:apppassword@localhost:5432/appdb?schema=public
DB_USER=appuser
DB_PASSWORD=apppassword           # CHANGE IN PRODUCTION â€” use a strong random password
DB_NAME=appdb
DB_PORT=5432

# ==========================================
# Session
# ==========================================
# SECURITY: Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
SESSION_SECRET=change-me-to-a-random-64-char-string-in-production-NEVER-use-this-default
SESSION_MAX_AGE=86400000          # 24 hours in milliseconds
SESSION_NAME=sid                  # Session cookie name

# ==========================================
# CSRF
# ==========================================
# SECURITY: Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
CSRF_HMAC_KEY=change-me-to-a-random-32-char-string-in-production

# ==========================================
# CORS
# ==========================================
CORS_ORIGIN=http://localhost:5173  # Frontend URL (Vite default)

# ==========================================
# Security
# ==========================================
LOCKOUT_THRESHOLD=5               # Failed login attempts before account lockout
LOCKOUT_DURATION_MINUTES=15       # Initial lockout duration (escalates on repeated lockouts)

# ==========================================
# Rate Limiting
# ==========================================
RATE_LIMIT_GLOBAL_MAX=100         # Max requests per minute per IP (global)
RATE_LIMIT_AUTH_MAX=5             # Max auth attempts per 15 min window per IP

# ==========================================
# Feature Flags
# ==========================================
FEATURE_2FA_ENABLED=false         # Enable TOTP 2FA support

# ==========================================
# Secrets Management Notes
# ==========================================
# - NEVER commit this file with real secrets. Copy to .env and edit locally.
# - In production, use environment variables from your hosting provider,
#   a secrets manager (AWS Secrets Manager, Vault, etc.), or CI/CD secrets.
# - Rotate SESSION_SECRET and CSRF_HMAC_KEY periodically. Rotating
#   SESSION_SECRET will invalidate all existing sessions (users must re-login).
# - Database credentials should use a dedicated user with minimal permissions.
